from aiogram import Bot, Dispatcher, Router
from aiogram.filters import CommandStart
from aiogram.types import Message, User, ContentType
from aiogram_dialog import Dialog, DialogManager, StartMode, Window, ShowMode
from aiogram_dialog.widgets.kbd import Button, Row, SwitchTo, Column, Start, Url, Group, Back, Cancel
from aiogram_dialog.widgets.text import Format, Const
from aiogram_dialog.widgets.media import DynamicMedia


from bot_states.base_states import Menu, PrizeDraw
from .dialogs_getters.getters import username_getter
from .dialog_handlers.callback_logic import ask_question_button, products_60_120, products_75_150


router_dialog = Router()

start_dialog = Dialog(
    Window(
        Format('–ü—Ä–∏–≤–µ—Ç, {username}!\n\
–ù–∞ —Å–≤—è–∑–∏ –∫–æ–º–∞–Ω–¥–∞ RichCat. \n\
–°–ø–∞—Å–∏–±–æ, —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏ –Ω–∞—Å! \n\n\
–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–∞—à–∏–º –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–æ–º, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–Ω—è—Ç—å —É—á–∞—Å—Ç–∏–µ –≤ –†–û–ó–´–ì–†–´–®–ï –ó–ê –û–¢–ó–´–í\n\n\
–î–ª—è —ç—Ç–æ–≥–æ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—É–Ω–∫—Ç\n'),
        Row(
            Start(
                text=Const('–ù–∞—à–∏ —Ç–æ–≤–∞—Ä—ã'),
                id='product',
                state=Menu.product_size
            ),
            Start(
                text=Const('–†–æ–∑—ã–≥—Ä—ã—à'),
                id='gift',
                state=PrizeDraw.prize_condition
            )
        ),
        Column(
            Start(
                text=Const('–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å'),
                id='ask_question_gift',
                state=Menu.help_rich_cat
            )
        ),
        getter=username_getter,
        state=Menu.start
    ),
    Window(
        Const('–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å –≤ –Ω–∞—à–µ–º —á–∞—Ç–µ.\nhttps://t.me/RichCat_help_bot'),
        Column(
            Back(
                Const('‚óÄÔ∏è'),
                id='back',
            ),
        ),
        state=Menu.help_rich_cat),
    Window(
        Const('–í—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞'),
        Row(
            Button(
                Const('60*120'),
                id='go_to_60_120',
                on_click=products_60_120,
            ),
            Button(
                Const('75*150'),
                id='go_to_75_150',
                on_click=products_75_150,
            ),
        ),
        Column(
            SwitchTo(
                Const('‚óÄÔ∏è'),
                id='back',
                state=Menu.start
            )
        ),
        state=Menu.product_size
    ),
    Window(
        Const('–°—Å—ã–ª–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä'),
        Row(
            Url(
                text=Const('126758787'),
                url=Const(
                    'https://www.wildberries.ru/catalog/126758787/detail.aspx'),
                id='126758787'),
            Url(
                text=Const('194079890'),
                url=Const(
                    'https://www.wildberries.ru/catalog/194079890/detail.aspx'),
                id='194079890'),
            Url(
                text=Const('194079888'),
                url=Const(
                    'https://www.wildberries.ru/catalog/194079888/detail.aspx'),
                id='194079888'),
        ),
        Row(
            Url(
                text=Const('194079894'),
                url=Const(
                    'https://www.wildberries.ru/catalog/194079894/detail.aspx'),
                id='194079894'),
            Url(
                text=Const('126025374'),
                url=Const(
                    'https://www.wildberries.ru/catalog/126025374/detail.aspx'),
                id='126025374'),
            Url(
                text=Const('126756271'),
                url=Const(
                    'https://www.wildberries.ru/catalog/126756271/detail.aspx'),
                id='126756271'),
        ),
        Column(
            SwitchTo(
                Const('‚óÄÔ∏è'),
                id='back',
                state=Menu.start
            )
        ),
        state=Menu.Url_60_120
    ),
    Window(
        Const('–°—Å—ã–ª–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä'),
        Row(
            Url(
                text=Const('194079892'),
                url=Const(
                    'https://www.wildberries.ru/catalog/194079892/detail.aspx'),
                id='194079892'),
            Url(
                text=Const('194079893'),
                url=Const(
                    'https://www.wildberries.ru/catalog/194079893/detail.aspx'),
                id='194079893'),
            Url(
                text=Const('194079891'),
                url=Const(
                    'https://www.wildberries.ru/catalog/194079891/detail.aspx'),
                id='194079891'),
        ),
        Row(
            Url(
                text=Const('128615052'),
                url=Const(
                    'https://www.wildberries.ru/catalog/128615052/detail.aspx'),
                id='194079894'),
            Url(
                text=Const('128603867'),
                url=Const(
                    'https://www.wildberries.ru/catalog/128603867/detail.aspx'),
                id='128603867'),
        ),
        Column(
            SwitchTo(
                Const('‚óÄÔ∏è'),
                id='back',
                state=Menu.start
            )
        ),
        state=Menu.Url_75_150
    )
)


prize_dilog = Dialog(
    Window
    (
        Const('''–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –≤—ã–±–æ—Ä –Ω–∞—à–µ–≥–æ –±—Ä–µ–Ω–¥–∞. –≠—Ç–æ –Ω–∞—Å –æ—á–µ–Ω—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –í–∞—Å —Ä–∞–¥–æ–≤–∞—Ç—å.
–î–ª—è –Ω–∞—Å –≤–∞–∂–Ω–æ –í–∞—à–µ –º–Ω–µ–Ω–∏–µ –æ –Ω–∞—à–∏—Ö –∫–æ–≤—Ä–∞—Ö.
–ü–æ—ç—Ç–æ–º—É –º—ã —Ä–µ—à–∏–ª–∏ –ö–ê–ñ–î–´–ô –ú–ï–°–Ø–¶ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –†–û–ó–´–ì–†–´–®
—Å—Ä–µ–¥–∏ –ª—é–±–∏–º—ã—Ö –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∑–∞ –æ—Ç–∑—ã–≤ –∏ –¥–∞—Ä–∏—Ç—å –æ–¥–∏–Ω –∏–∑
–Ω–∞—à–∏—Ö –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã—Ö –ö–û–í–†–ò–ö–û–í –∏–∑ —ç–∫–æ-–º–µ—Ö–∞ 60*120 —Å–º
(—Ü–≤–µ—Ç –≤—ã–±–µ—Ä–µ—Ç –ø–æ–±–µ–¥–∏—Ç–µ–ª—å –∏–∑ —Ç–µ—Ö, —á—Ç–æ –≤ –Ω–∞–ª–∏—á–∏–∏)

–£–°–õ–û–í–ò–Ø –£–ß–ê–°–¢–ò–Ø:
–í–∞–º –Ω—É–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ –≤ —Ñ–µ–≤—Ä–∞–ª–µ 2024, –º–∞—Ä—Ç–µ 2024:
–ù–∞–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –≤ –∫–æ–≤—Ä–∞—Ö RichCat
–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ (—ç—Ç–æ –ø–æ –∂–µ–ª–∞–Ω–∏—é, –Ω–æ –Ω–∞–º –±—É–¥–µ—Ç –ø—Ä–∏—è—Ç–Ω–æ).
–ó–∞ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –æ—Ç–∑—ã–≤ –í–∞–º –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –¥–ª—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –í–∞–º –ø—Ä–∏—Å–ª–∞–Ω –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π

‚ùóÔ∏è–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ–±—ã –Ω–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –≤–∫–ª–∞–¥—ã—à –Ω–µ –ø–æ–ø–∞–ª –≤ –∫–∞–¥—Ä. –û –Ω–µ–º –∑–Ω–∞–µ–º —Ç–æ–ª—å–∫–æ –º—ã —Å –í–∞–º–∏üòâ

üö©–ò—Ç–æ–≥–∏ –ø–æ–¥–≤–µ–¥—ë–º 8 –∞–ø—Ä–µ–ª—è –≤ –Ω–∞—à–µ–º Telegram-–∫–∞–Ω–∞–ª–µ https://t.me/richcatkovry

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∏–Ω—è—Ç—å —É—á–∞—Å—Ç–∏–µ, –≤—ã–±–∏—Ä–∞–π—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—É–Ω–∫—Ç
'''),
        Group(
            Row(
                Start(text=Const("–î–∞–ª–µ–µ"),
                      id='first_screen',
                      state=PrizeDraw.review_screenshot),
                Button(text=Const('–ö–∞–∫ –æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤'),
                       id='das'),
                Start(
                    text=Const('–ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å'),
                    id='ask_question_gift',
                    state=PrizeDraw.help_rich_cat
                )
            ),
            Column(
                Cancel(
                    Const('‚óÄÔ∏è'),
                    id='cansel_prize_dilog',
                ),
            )
        ),
        state=PrizeDraw.prize_condition
    ),
    Window(
        Const('–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å –≤ –Ω–∞—à–µ–º —á–∞—Ç–µ.\nhttps://t.me/RichCat_help_bot'),
        Column(
            Back(
                Const('‚óÄÔ∏è'),
                id='back',
            ),
        ),
        state=PrizeDraw.help_rich_cat),

)


@ router_dialog.message(CommandStart())
async def command_start_process(message: Message, dialog_manager: DialogManager):
    await dialog_manager.start(state=Menu.start, mode=StartMode.RESET_STACK)
